from flask import Flask, jsonify, request, send_fileimport jsonfrom datetime import datetimeimport matplotlib.pyplot as pltfrom jobs import rd, add_job,return_job, return_imagefrom funcs import get_stock_diffapp = Flask(__name__)stocks = json.loads(rd.get("Stocks"))    @app.route('/', methods=['GET'])def instructions():    return """    Try these routes:        /                 informational    /stock/<ticker>?period=   gives you a graph with a 5 year history    /stock/<ticker>/date gives you the closing price of that particular date    /stock/diff?start=&end= gives you the % change between the dates of the stock    /stock/compare/<ticker1>/<ticker2>?period= compares two stocks with each other        /run              (GET) job instructions    /run              (POST) submit job    /jobs             get list of past jobs    /jobs/<UUID>      get job results    /delete           (GET) delete instructions    /delete           (DELETE) delete job    /download/<UUID>  download img from job """@app.route('/stock/graph', methods=['POST'])def stock_graph():    ticker = request.form.get('ticker')    job_type = 'graph'    input_values = {'ticker': ticker}        return add_job(job_type, json.dumps(input_values))    #Date must be in a %Y-%m-%d format@app.route('/stock/<string:ticker>', methods=['GET'])def stock_point(ticker):    my_stock = stocks[ticker]    date = request.args.get('date')        if date:        return jsonify(date + ': ' + str(my_stock[date]))    else:        return jsonify(my_stock)@app.route('/stock/compare', methods=['POST'])def compare_stock():    ticker1 = request.form.get('ticker1')    ticker2 = request.form.get('ticker2')    job_type = 'compare'    input_values = {'ticker1': ticker1, 'ticker2': ticker2}        return add_job(job_type, json.dumps(input_values))@app.route('/stock/diff/<string:ticker>/<string:period>', methods=['GET'])def stock_diff(ticker, period):    stock = stocks[ticker]    result = get_stock_diff(stock, period)        return result        @app.route('/jobs/<string:uid>', methods=['GET'])def get_job(uid):    return_dict = return_job(uid)    return return_dict@app.route('/download/<string:jobid>', methods=['GET'])def download(jobid):        path = '{}.png'.format(jobid)    with open(path, 'wb') as f:        f.write(return_image(jobid))    return send_file(path, mimetype='image/png', as_attachment=True)if __name__ == '__main__':    app.run(debug=True, host='0.0.0.0')